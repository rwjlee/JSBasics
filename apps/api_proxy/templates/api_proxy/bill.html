{% extends 'api_proxy/base.html' %} 

{% block body %}
<h1><a href="">Bill Tracker</a></h1>

<form action="#" method='POST' id="form1">
    {% csrf_token %}
    <div class="form-group row py-2">
        
        <input type="text" name="html_description" class="col-6 ml-3 rounded" placeholder="Description">
        <input type="text" name="html_amount" class="col-2 ml-2 rounded" placeholder="Amount">
        <button type="submit" class="btn btn-primary ml-2">Add Bill</button>
    </div>
</form>
<hr>

<div class="row copy-me my-1">
    <div class="col-6 ml-3 rounded"></div>
    <div class="col-2 ml-2 rounded"></div>
    <button type="submit" class="btn btn-danger ml-2">Delete</button>
</div>

<div class="allbills">

</div>


{% endblock %} 

{% block scripts %}
<script>
$(document).ready(function () {
    
    console.log("Bill basic");

    $("#form1 > .form-group > .btn").click(function(event) {
        event.preventDefault();

        $.ajax({
            type: $("this").
            
        })
        let value = $("input[name=html_amount]").val()
        let key = $("input[name=html_description").val()

        $(this).siblings().val("");

        if (Number(value)) {

            let bill = $(".copy-me").clone();
            bill.removeClass("copy-me");
            htmlDesc = bill.find(".col-6")
            htmlDesc.text(key);
            htmlAmt = bill.find(".col-2")
            htmlAmt.text(value);

            bill.find(".col-6").attr("contenteditable", true);
            bill.find(".col-2").attr("contenteditable", true);

            
            bill.find(".rounded").keypress(function(event) {
                if (event.keyCode === 13) {
                    event.preventDefault();
                    $(this).blur();
                    
                    if(isNaN(Number(bill.find(".col-2").text()))) {
                        bill.find(".col-2").text(0);
                    }
                }
            });

            bill.find(".btn").click(function(event) {
                $(this).parent().remove();
            })

            $(".allbills").append(bill);
            
        }
    });
});
</script> 

{% endblock %}